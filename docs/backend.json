{
  "entities": {
    "Patient": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Patient",
      "type": "object",
      "description": "Representa um paciente recebendo serviços de homecare, com estrutura de dados ampliada.",
      "properties": {
        "id": { "type": "string", "description": "Identificador único para o paciente (Auto)." },
        "firstName": { "type": "string", "description": "Nome do paciente." },
        "lastName": { "type": "string", "description": "Sobrenome do paciente." },
        "displayName": { "type": "string", "description": "Nome preferido / nome social." },
        "pronouns": { "type": "string", "description": "Pronomes de preferência (ex: ele/dele, ela/dela)." },
        "avatarUrl": { "type": "string", "format": "uri", "description": "Foto do Paciente para identificação visual." },
        "avatarHint": { "type": "string" },
        "photoConsent": {
          "type": "object",
          "properties": {
            "granted": { "type": "boolean" },
            "grantedBy": { "type": "string" },
            "date": { "type": "string", "format": "date-time" }
          }
        },

        "cpf": { "type": "string", "description": "CPF para documentação." },
        "cpfStatus": { "type": "string", "enum": ["valid", "invalid", "unknown"] },
        "rg": { "type": "string", "description": "RG para documentação complementar." },
        "rgIssuer": { "type": "string", "description": "Órgão emissor do RG." },
        "rgDigitalUrl": { "type": "string", "format": "uri" },
        "cns": { "type": "string", "description": "Cartão Nacional de Saúde (CNS)." },
        "nationalId": { "type": "string", "description": "Documento de identificação para estrangeiros." },
        "documentValidation": {
          "type": "object",
          "properties": {
            "status": { "type": "string", "enum": ["none", "pending", "validated"] },
            "validatedBy": { "type": "string" },
            "validatedAt": { "type": "string", "format": "date-time" },
            "method": { "type": "string", "enum": ["ocr", "manual"] }
          }
        },

        "dateOfBirth": { "type": "string", "format": "date", "description": "Data de Nascimento." },
        "sexo": { "type": "string", "enum": ["Masculino", "Feminino", "Outro"], "description": "Sexo biológico." },
        "genderIdentity": { "type": "string", "description": "Identidade de gênero." },
        "estadoCivil": { "type": "string", "description": "Estado civil." },
        "nacionalidade": { "type": "string" },
        "naturalidade": { "type": "string", "description": "Cidade/UF de nascimento." },
        "preferredLanguage": { "type": "string" },

        "phones": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": { "type": "string", "enum": ["mobile", "home", "work"] },
              "number": { "type": "string" },
              "verified": { "type": "boolean" },
              "preferred": { "type": "boolean" }
            }
          }
        },
        "emails": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "email": { "type": "string", "format": "email" },
              "verified": { "type": "boolean" },
              "preferred": { "type": "boolean" }
            }
          }
        },
        "preferredContactMethod": { "type": "string", "enum": ["Telefone", "WhatsApp", "Email"] },
        "communicationOptOut": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": { "type": "string", "enum": ["sms", "email", "whatsapp"] },
              "optedOut": { "type": "boolean" },
              "date": { "type": "string", "format": "date-time" }
            }
          }
        },
        
        "emergencyContacts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "relationship": { "type": "string" },
              "phone": { "type": "string" },
              "email": { "type": "string", "format": "email" },
              "isLegalRepresentative": { "type": "boolean" },
              "permissions": {
                "type": "object",
                "properties": {
                  "view": { "type": "boolean" },
                  "authorize": { "type": "boolean" }
                }
              },
              "documentUrl": { "type": "string", "format": "uri" }
            }
          }
        },
        "legalGuardian": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "document": { "type": "string" },
            "validityDate": { "type": "string", "format": "date" },
            "powerOfAttorneyUrl": { "type": "string", "format": "uri" }
          }
        },
        
        "address": {
          "type": "object",
          "description": "Endereço e detalhes do ambiente domiciliar.",
          "properties": {
            "street": {"type": "string"},
            "number": {"type": "string"},
            "complement": {"type": "string"},
            "neighborhood": {"type": "string"},
            "city": {"type": "string"},
            "state": {"type": "string"},
            "zipCode": {"type": "string"},
            "pontoReferencia": { "type": "string", "description": "Ponto de referência para logística de atendimento." },
            "tipoResidencia": { "type": "string", "enum": ["Casa", "Apartamento", "Chácara", "Condomínio"], "description": "Tipo de residência para planejamento de visita." },
            "condicoesDomicilio": { "type": "string", "description": "Condições do domicílio para avaliação de risco (acesso, escadas, elevador, iluminação)." },
            "acessoAmbulancia": { "type": "boolean", "description": "Se há acesso fácil para ambulância." },
            "possuiAnimal": { "type": "boolean", "description": "Se há animais domésticos na residência." },
            "animalDescricao": { "type": "string", "description": "Descrição dos animais, se houver." }
          }
        },

        "clinicalData": {
          "type": "object",
          "description": "Dados clínicos e assistenciais detalhados.",
          "properties": {
            "diagnoses": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "code": { "type": "string" }
                },
                "required": ["name"]
              }
            },
            "equipamentosDomiciliares": { "type": "array", "items": { "type": "string" }, "description": "Equipamentos como oxigênio, cama hospitalar, etc." },
            "diagnosticoPrincipal": { "type": "string", "description": "Diagnóstico principal que baseia o plano de cuidado." },
            "diagnosticosSecundarios": { "type": "array", "items": { "type": "string" }, "description": "Diagnósticos secundários para contexto clínico." },
            "cid": { "type": "array", "items": { "type": "string" }, "description": "Códigos CID para indexação médica." },
            "allergies": { "type": "array", "items": { "type": "string" }, "description": "Lista de alergias conhecidas." },
            "restricoes": { "type": "array", "items": { "type": "string" }, "description": "Restrições alimentares, físicas, etc." },
            "mobilidade": { "type": "string", "enum": ["Autônomo", "Parcialmente Dependente", "Acamado"], "description": "Escala de dependência de mobilidade." },
            "estadoConsciencia": { "type": "string", "description": "Avaliação neurológica básica do paciente." },
            "dispositivos": { "type": "array", "items": { "type": "string", "enum": ["GTT", "SNE", "CVD", "Traqueostomia"] }, "description": "Uso de dispositivos como GTT, SNE, etc." },
            "acessorios": { "type": "string", "description": "Dispositivos e acessórios como cadeira de rodas, andador." },
            "medications": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "name": {"type": "string"},
                        "dosage": {"type": "string"},
                        "frequency": {"type": "string"},
                        "notes": {"type": "string"}
                    },
                    "required": ["name", "dosage", "frequency"]
                },
                "description": "A list of medications the patient is taking."
            },
            "ultimaAvaliacaoMedica": { "type": "string", "format": "date", "description": "Data da última avaliação médica." },
            "ultimoExameLaboratorial": { "type": "string", "format": "date", "description": "Data do último exame laboratorial." },
            "observacoesGerais": { "type": "string", "description": "Campo livre para observações clínicas gerais." }
          }
        },

        "adminData": {
          "type": "object",
          "description": "Informações administrativas e internas.",
          "properties": {
            "status": { "type": "string", "enum": ["Ativo", "Inativo", "Suspenso"], "description": "Status do paciente para controle de escala." },
            "complexity": { "type": "string", "enum": ["Baixa", "Média", "Alta"], "description": "Nível de complexidade para dimensionamento da equipe." },
            "servicePackage": { "type": "string", "enum": ["Básico", "Intermediário", "Completo"], "description": "Plano comercial contratado." },
            "dataInicioAtendimento": { "type": "string", "format": "date", "description": "Data de início do atendimento." },
            "dataTerminoAtendimento": { "type": "string", "format": "date", "description": "Data de término, se aplicável." },
            "supervisorId": { "type": "string", "description": "ID do profissional supervisor." },
            "schedulerId": { "type": "string", "description": "ID do profissional escalista." },
            "enfermeiroResponsavelId": { "type": "string", "description": "ID do enfermeiro responsável para registro no COREN." },
            "cuidadoresIds": { "type": "array", "items": { "type": "string" }, "description": "IDs dos cuidadores principais." },
            "frequenciaAtendimento": { "type": "string", "description": "Frequência planejada de atendimento (ex: 24h, 12h, 3x/semana)." },
            "observacoesInternas": { "type": "string", "description": "Observações restritas à equipe interna." }
          }
        },

        "financial": {
          "type": "object",
          "description": "Informações financeiras para faturamento.",
          "properties": {
            "vinculo": { "type": "string", "enum": ["Plano de Saúde", "Particular", "Convênio", "Público"], "description": "Tipo de vínculo para faturamento." },
            "operadora": { "type": "string", "description": "Nome da operadora do plano de saúde." },
            "carteirinha": { "type": "string", "description": "Número da carteirinha do plano." },
            "validadeCarteirinha": { "type": "string", "format": "date", "description": "Data de validade da carteirinha." },
            "monthlyFee": { "type": "number", "description": "Valor da mensalidade ou do pacote." },
            "billingDay": { "type": "number", "description": "Dia do vencimento para faturamento." },
            "formaPagamento": { "type": "string", "description": "Forma de pagamento acordada." },
            "observacoesFinanceiras": { "type": "string", "description": "Observações sobre o faturamento." }
          }
        },


        "documents": {
          "type": "object",
          "description": "URLs para documentos e consentimentos.",
          "properties": {
            "termoConsentimentoUrl": { "type": "string", "format": "uri" },
            "termoLgpdUrl": { "type": "string", "format": "uri" },
            "documentoComFotoUrl": { "type": "string", "format": "uri" },
            "comprovanteEnderecoUrl": { "type": "string", "format": "uri" },
            "fichaAvaliacaoEnfermagemUrl": { "type": "string", "format": "uri" },
            "planoCuidadoUrl": { "type": "string", "format": "uri" },
            "protocoloAuditoriaUrl": { "type": "string", "format": "uri" }
          }
        },

        "audit": {
          "type": "object",
          "description": "Histórico e auditoria do registro.",
          "properties": {
            "createdAt": { "type": "string", "format": "date-time" },
            "createdBy": { "type": "string" },
            "updatedAt": { "type": "string", "format": "date-time" },
            "updatedBy": { "type": "string" }
          }
        },
        
        "last_visit_date": { "type": "string", "format": "date", "description": "Data do último plantão/visita." },
        "next_visit_date": { "type": "string", "format": "date", "description": "Data do próximo plantão/visita agendado." },
        "consent_status": { "type": "string", "enum": ["ok", "pending"], "description": "Status do termo de consentimento (LGPD)." },
        "pending_documents": { "type": "number", "description": "Contagem de documentos importantes faltando." }
      },
      "required": [ "id", "firstName", "lastName", "cpf", "dateOfBirth", "address" ]
    },
    "Professional": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Professional",
      "type": "object",
      "description": "Represents a healthcare professional in the system.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "initials": { "type": "string" },
        "email": { "type": "string", "format": "email" },
        "phone": { "type": "string" },
        "cpf": { "type": "string" },
        "dateOfBirth": { "type": "string", "format": "date" },
        "address": { "$ref": "#/entities/Patient/properties/address" },
        "avatarUrl": { "type": "string" },
        "avatarHint": { "type": "string" },
        "rating": { "type": "number" },
        "bio": { "type": "string" },
        "coren": { "type": "string" },
        "corenStatus": { "type": "string", "enum": ["active", "inactive"] },
        "reviews": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "from": {"type": "string"},
                    "quote": {"type": "string"}
                }
            }
        },
        "specialties": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["id", "name", "email", "coren"]
    },
    "Shift": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Shift",
        "type": "object",
        "description": "Represents a work shift for a professional with a patient.",
        "properties": {
            "id": { "type": "string" },
            "patientId": { "type": "string" },
            "professionalId": { "type": "string" },
            "dayKey": { "type": "string", "description": "YYYY-MM-DD format" },
            "shiftType": { "type": "string", "enum": ["diurno", "noturno"] },
            "status": { "type": "string", "enum": ["open", "pending", "filled", "active", "completed", "issue"] },
            "isUrgent": { "type": "boolean" },
            "progress": { "type": "number" },
            "checkIn": { "type": "string", "format": "time" },
            "checkOut": { "type": "string", "format": "time" },
            "checkInStatus": { "type": "string", "enum": ["OK", "Pendente", "Falha"] },
            "checkOutStatus": { "type": "string", "enum": ["OK", "Pendente", "Falha"] },
            "hasNotification": { "type": "boolean" }
        },
        "required": ["id", "patientId", "dayKey", "shiftType", "status"]
    },
    "Supply": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Supply",
      "type": "object",
      "description": "Represents a supply item used in patient care.",
      "properties": {
        "id": { "type": "string" }, "name": { "type": "string" }, "description": { "type": "string" }, "unit": { "type": "string" }
      },
      "required": [ "id", "name", "description", "unit" ]
    },
    "Inventory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Inventory",
      "type": "object",
      "description": "Inventory entry for a specific supply tracked per patient.",
      "properties": {
        "id": { "type": "string" },
        "patientId": { "type": "string" },
        "supplyId": { "type": "string" },
        "name": { "type": "string" },
        "description": { "type": "string" },
        "stock": { "type": "number" },
        "lowStockThreshold": { "type": "number" }
      },
      "required": [ "id", "patientId", "supplyId", "name", "stock", "lowStockThreshold" ]
    },
    "SupplyRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SupplyRequest",
      "type": "object",
      "description": "Represents a request for supplies made by the care team to the family.",
      "properties": {
        "id": { "type": "string" }, "patientId": { "type": "string" }, "supplyId": { "type": "string" },
        "quantityRequested": { "type": "number" }, "requestDate": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["pending", "approved", "denied"] }, "notes": { "type": "string" }
      },
      "required": [ "id", "patientId", "supplyId", "quantityRequested", "requestDate", "status" ]
    },
    "ShiftReport": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ShiftReport",
      "type": "object",
      "description": "Represents a shift report submitted by a care team member.",
      "properties": {
        "id": { "type": "string" },
        "patientId": { "type": "string" },
        "careTeamMemberName": { "type": "string" },
        "shift": { "type": "string", "enum": ["diurno", "noturno"] },
        "reportDate": { "type": "string", "format": "date-time" },
        "observations": { "type": "string" },
        "vitalSigns": {
            "type": "object",
            "properties": {
                "bloodPressure": {"type": "string"},
                "heartRate": {"type": "number"},
                "oxygenSaturation": {"type": "number"}
            }
        }
      },
      "required": [ "id", "patientId", "careTeamMemberName", "shift", "reportDate", "observations" ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification for the dashboard.",
      "properties": {
        "id": { "type": "string" }, "patientId": { "type": "string" },
        "type": { "type": "string", "enum": ["supply", "info", "alert"] },
        "message": { "type": "string" },
        "timestamp": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "patientId", "type", "message", "timestamp"]
    }
  },
  "auth": {
    "providers": [ "password", "google.com" ]
  },
  "firestore": {
    "/patients/{patientId}": { "schema": { "$ref": "#/entities/Patient" }, "description": "Stores individual patient records." },
    "/professionals/{professionalId}": { "schema": { "$ref": "#/entities/Professional" }, "description": "Stores individual professional records." },
    "/shifts/{shiftId}": { "schema": { "$ref": "#/entities/Shift" }, "description": "Stores all shifts for all patients. The shiftId is a composite key for easy lookup: {patientId}-{dayKey}-{shiftType}." },
    "/patients/{patientId}/inventories/{inventoryId}": { "schema": { "$ref": "#/entities/Inventory" }, "description": "Inventory for a specific patient." },
    "/patients/{patientId}/supplyRequests/{supplyRequestId}": { "schema": { "$ref": "#/entities/SupplyRequest" }, "description": "Supply requests for a patient." },
    "/patients/{patientId}/shiftReports/{shiftReportId}": { "schema": { "$ref": "#/entities/ShiftReport" }, "description": "Shift reports for a patient." },
    "/patients/{patientId}/notifications/{notificationId}": { "schema": { "$ref": "#/entities/Notification" }, "description": "Notifications for a patient." }
  }
}

    
