{
  "entities": {
    "Patient": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Patient",
      "type": "object",
      "description": "Represents a patient receiving homecare services.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the patient." },
        "name": { "type": "string", "description": "The patient's full name." },
        "cpf": { "type": "string", "description": "The patient's CPF document number." },
        "email": { "type": "string", "description": "The patient's email address.", "format": "email" },
        "phone": { "type": "string", "description": "The patient's phone number." },
        "dateOfBirth": { "type": "string", "description": "The patient's date of birth.", "format": "date" },
        "bloodType": { "type": "string", "description": "The patient's blood type." },
        "age": { "type": "number", "description": "The patient's age." },
        "avatarUrl": { "type": "string", "description": "URL for the patient's avatar image." },
        "avatarHint": { "type": "string", "description": "A hint for AI to find a similar image." },
        "address": {
            "type": "object",
            "properties": {
                "street": {"type": "string"},
                "number": {"type": "string"},
                "complement": {"type": "string"},
                "neighborhood": {"type": "string"},
                "city": {"type": "string"},
                "state": {"type": "string"},
                "zipCode": {"type": "string"}
            }
        },
        "financial": {
            "type": "object",
            "properties": {
                "plan": {"type": "string", "enum": ["particular", "plano_de_saude"]},
                "healthPlan": {"type": "string"},
                "healthPlanId": {"type": "string"},
                "monthlyFee": {"type": "number"},
                "billingDay": {"type": "number"}
            }
        },
        "familyContact": {
            "type": "object",
            "properties": {
                "name": {"type": "string"},
                "phone": {"type": "string"}
            }
        },
        "allergies": { "type": "array", "items": { "type": "string" }, "description": "A list of the patient's known allergies." },
        "chronicConditions": { "type": "array", "items": { "type": "string" }, "description": "A list of the patient's chronic conditions." },
        "medications": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {"type": "string"},
                    "dosage": {"type": "string"},
                    "frequency": {"type": "string"},
                    "notes": {"type": "string"}
                },
                 "required": ["name", "dosage", "frequency"]
            },
            "description": "A list of medications the patient is taking."
        },
        "diet": { "type": "string", "description": "Dietary restrictions and recommendations for the patient." }
      },
      "required": [ "id", "name", "dateOfBirth", "familyContact" ]
    },
    "Professional": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Professional",
      "type": "object",
      "description": "Represents a healthcare professional in the system.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "initials": { "type": "string" },
        "email": { "type": "string", "format": "email" },
        "phone": { "type": "string" },
        "cpf": { "type": "string" },
        "dateOfBirth": { "type": "string", "format": "date" },
        "address": { "$ref": "#/backend/entities/Patient/properties/address" },
        "avatarUrl": { "type": "string" },
        "avatarHint": { "type": "string" },
        "rating": { "type": "number" },
        "bio": { "type": "string" },
        "coren": { "type": "string" },
        "corenStatus": { "type": "string", "enum": ["active", "inactive"] },
        "reviews": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "from": {"type": "string"},
                    "quote": {"type": "string"}
                }
            }
        },
        "specialties": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["id", "name", "email", "coren"]
    },
    "Shift": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Shift",
        "type": "object",
        "description": "Represents a work shift for a professional with a patient.",
        "properties": {
            "id": { "type": "string" },
            "patientId": { "type": "string" },
            "professionalId": { "type": "string" },
            "dayKey": { "type": "string", "description": "YYYY-MM-DD format" },
            "shiftType": { "type": "string", "enum": ["diurno", "noturno"] },
            "status": { "type": "string", "enum": ["open", "pending", "filled", "active", "completed", "issue"] },
            "isUrgent": { "type": "boolean" },
            "progress": { "type": "number" },
            "checkIn": { "type": "string", "format": "time" },
            "checkOut": { "type": "string", "format": "time" },
            "checkInStatus": { "type": "string", "enum": ["OK", "Pendente", "Falha"] },
            "checkOutStatus": { "type": "string", "enum": ["OK", "Pendente", "Falha"] },
            "hasNotification": { "type": "boolean" }
        },
        "required": ["id", "patientId", "dayKey", "shiftType", "status"]
    },
    "Supply": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Supply",
      "type": "object",
      "description": "Represents a supply item used in patient care.",
      "properties": {
        "id": { "type": "string" }, "name": { "type": "string" }, "description": { "type": "string" }, "unit": { "type": "string" }
      },
      "required": [ "id", "name", "description", "unit" ]
    },
    "Inventory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Inventory",
      "type": "object",
      "description": "Represents the inventory level of a specific supply item for a patient.",
      "properties": {
        "id": { "type": "string" },
        "patientId": { "type": "string" },
        "supplyId": { "type": "string" },
        "quantity": { "type": "number" },
        "lastUpdated": { "type": "string", "format": "date-time" }
      },
      "required": [ "id", "patientId", "supplyId", "quantity", "lastUpdated" ]
    },
    "SupplyRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SupplyRequest",
      "type": "object",
      "description": "Represents a request for supplies made by the care team to the family.",
      "properties": {
        "id": { "type": "string" }, "patientId": { "type": "string" }, "supplyId": { "type": "string" },
        "quantityRequested": { "type": "number" }, "requestDate": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["Pending", "Approved", "Denied"] }, "notes": { "type": "string" }
      },
      "required": [ "id", "patientId", "supplyId", "quantityRequested", "requestDate", "status" ]
    },
    "ShiftReport": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ShiftReport",
      "type": "object",
      "description": "Represents a shift report submitted by a care team member.",
      "properties": {
        "id": { "type": "string" },
        "patientId": { "type": "string" },
        "careTeamMemberName": { "type": "string" },
        "shift": { "type": "string", "enum": ["Diurno", "Noturno"] },
        "reportDate": { "type": "string", "format": "date-time" },
        "observations": { "type": "string" },
        "vitalSigns": {
            "type": "object",
            "properties": {
                "bloodPressure": {"type": "string"},
                "heartRate": {"type": "number"},
                "oxygenSaturation": {"type": "number"}
            }
        }
      },
      "required": [ "id", "patientId", "careTeamMemberName", "shift", "reportDate", "observations" ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification for the dashboard.",
      "properties": {
        "id": { "type": "string" }, "patientId": { "type": "string" },
        "type": { "type": "string", "enum": ["supply", "info", "alert"] },
        "message": { "type": "string" },
        "timestamp": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "patientId", "type", "message", "timestamp"]
    }
  },
  "auth": {
    "providers": [ "password", "google.com" ]
  },
  "firestore": {
    "/patients/{patientId}": { "schema": { "$ref": "#/backend/entities/Patient" }, "description": "Stores individual patient records." },
    "/professionals/{professionalId}": { "schema": { "$ref": "#/backend/entities/Professional" }, "description": "Stores individual professional records." },
    "/shifts/{shiftId}": { "schema": { "$ref": "#/backend/entities/Shift" }, "description": "Stores all shifts for all patients. The shiftId is a composite key for easy lookup: {patientId}-{dayKey}-{shiftType}." },
    "/patients/{patientId}/inventories/{inventoryId}": { "schema": { "$ref": "#/backend/entities/Inventory" }, "description": "Inventory for a specific patient." },
    "/patients/{patientId}/supplyRequests/{supplyRequestId}": { "schema": { "$ref": "#/backend/entities/SupplyRequest" }, "description": "Supply requests for a patient." },
    "/patients/{patientId}/shiftReports/{shiftReportId}": { "schema": { "$ref": "#/backend/entities/ShiftReport" }, "description": "Shift reports for a patient." },
    "/patients/{patientId}/notifications/{notificationId}": { "schema": { "$ref": "#/backend/entities/Notification" }, "description": "Notifications for a patient." }
  }
}
